package com.example.helloworldjava.view.SpeechBookTest;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.speech.tts.TextToSpeech;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

import com.example.helloworldjava.R;

import org.w3c.dom.Text;

import java.util.Locale;
import java.util.UUID;

public class SpeechActivity extends AppCompatActivity {
    TextToSpeech textToSpeech;
    Button btnPlay;
    Button btnPause;
    Button btnNext;
    Button btnPrevious;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_speech);
        demoSpeech();
    }




    public void demoSpeech(){

        // Tao demobook de doc thu
        SachContent demobook = new SachContent();
        demobook.Name_chapter = "Cuối cùng chu kỳ, cầu thông hắc ám";
        demobook.numberofpage = 200;
        demobook.numberofchapter = 1328;
        String content = "Nhớ lại năm 1898, một thảm kịch đã xảy ra tại thị trấn Rorland - New York. Buổi sáng đầy tuyết lạnh và trơn trợt hôm đó, Joe Farley ra chuồng ngựa, đấm yên cương để dự đám tang một đứa bé thì con ngựa bỗng dưng trở chứng và tung một cú đá hầu, làm anh tử vong tại chỗ để lại vợ và ba đứa con trai cùng vài trăm đô-la tiền bảo hiểm. Người con trai lớn nhất của anh, Jim, 10 tuổi, phải bỏ học để làm việc kiếm sống tại một nhà máy gạch. Cậu làm đủ mọi việc từ đẩy xe xúc, đổ đất vào khuôn rồi sắp gạch đi phơi nắng. Jim không được may mắn học hành đến nơi đến chốn nhưng với tánh tình vui vẻ tự nhiên, cậu rất dễ làm cho người khác yêu mến mình. Năm tháng trôi qua, cậu bé ngày xưa đã trở thành một người đàn ông từng trải bước vào chính trường và trở thành một chính trị gia có tài nhớ tên người một cách kỳ lạ. Ông chưa bao giờ được nghe giảng ở một trường Đại học nào cả nhưng trước năm 46 tuổi, 4 trường Đại học đã tặng cho ông nhiều học vị danh dự rồi ông trở thành Chủ tịch Uỷ ban toàn Quốc đảng Dân Chủ và là Tổng Giám Đốc của bưu điện Mỹ. Tôi đã có lần phỏng vấn và hỏi Jim Farley về bí quyết thành công. Ông trả lời : \"Cần cù làm việc\" Tôi đáp lại : \"Ông đừng nói đùa nhé !\" Ông hỏi ngược lại là theo tôi thì lý do gì khiến ông thành công. Tôi đáp : \"Tôi biết ông có thể nhớ tên riêng của 10.000 người\" Ông đáp lại : \"Không ! Ông sai rồi. Tôi có thể nhớ tên riêng của 50.000 người\". Chính khả năng đặc biệt này đã giúp cho Jim Farley đưa Franklin Roosevelt vào Nhà trắng khi ông điều hành chiến dịch tranh cử Tổng thống cho Roosevelt vào năm 1932. Trong những năm lăn lộn với cuộc sống, trải qua rất nhiều nghề, khi thì bán hàng cho một xí nghiệp thạch cao, khi thì phụ trách văn thư Toà thị chính Staniford, ông đã xây dựng được quy tắc nhớ tên người. Mỗi khi mới làm quen với một người nào đó, ông tìm hiểu tên đầy đủ cũng như một vài sự kiện về gia đình, công việc và quan điểm chính trị của người đó. Ông ghi nhớ tỉ mỉ mọi thông tin này vào trí óc như từng chi tiết của một bức tranh. Lần sau khi gặp lại, dù đã một năm sau, ông vẫn có thể bắt tay và hỏi thăm về gia đình hay hỏi về cây trồng ở sân sau nhà người đó. Bằng cách này, ông có được sự quý mến của rất nhiều người. Trước chiến dịch tranh cử Tổng thống của Roosevelt, mổi ngày Jim Farley viết hàng trăm bức thư cho cử tri khắp các Bang miền tây và tây bắc. Sau đó, trong vòng 19 ngày, ông đã đi khắp 20 Bang, gần 20.000 km bằng nhiều loại phương tiện khác nhau. Đến mỗi nơi, ông bày tỏ những trăn trở của mình với cử tri qua các cuộc gặp gở thân mật : uống trà sáng, ăn trưa hay ăn tối rồi lại lên đường bắt đầu một cuộc hành trình mới. Ngay khi trở về miền đông, ông viết thư cho những người thân nhất trong từng vùng mà ông đã đi thăm và hỏi họ danh sách những người đã đến dự buổi nói chuyện của ông. Cuối cùng gộp lại, danh sách đó lên tới hàng chục ngàn cái tên. Thế mà, từng người một trên danh sách này đều nhận được thư riêng của Jim Farley. Những bức thư thường bắt đầu bằng \"Bill thân mến\" hay \" Charles thân mến\" và bao giờ cũng được ký tên đơn giản là \"Jim\". Jim Farley đã sớm phát hiện rằng mọi người bình thường đều quan tâm đến tên riêng của mình nhiều hơn mọi cái tên riêng khác trên trái đất này cộng lại. Chỉ cần nhớ tên riêng của từng người, phát âm nó chuẩn xác là bạn đã tặng một lời khen tế nhị và rất hiệu quả cho người đó. Còn như nếu bạn quên, phát âm sai tên người khác cũng đồng nghĩa với việc bạn tự đặt mình vào một tình cảnh rất khó chịu. Có lần, tôi tổ chức một khoá diễn thuyết ở Paris và gửi thư cho tất cả công dân Mỹ đang sống tại thành phố này. Các nhân viên đánh máy lại không thạo tiếng Anh cho lắm, nên đã phạm nhiều lỗi khi điền tên riêng của họ. Giám đốc một ngân hàng lớn của Mỹ ở Paris, sau đó  đã viết cho tôi một lời phê bình gay gắt vì cái tên của ông bị viết sai. Đôi khi thật khó mà nhớ được tên một người, nhất là khi cái tên đó được phát âm rất phức tạp. Nhiều người thậm chí còn không chịu học cách phát âm mà lại gọi người đó bằng một biệt hiệu cho dể nhớ. Cid Levy đến thăm một khách hàng mà người chủ có tên riêng là Nikodemos  Papadolos nhưng hầu hết mọi người đều gọi ông ấy là Nik. Levy nói : - Tôi cố gắng tập phát âm tên ông ấy suốt nhiều tuần trước khi đến thăm ông. Khi tôi chào ông bằng cái tên đầy đủ của ông \"Chào ông Nikodemos Papadolos\" thì ông vô cùng ngạc nhiên. Sau vài phút im lặng, ông cảm động nói : - Ông Levy này, suốt 15 năm tôi sống trên đất nước này, chưa hề có ai gọi đúng cái tên của tôi cả ! Bạn biết điều gì đã mang lại thành công cho Andrew Carnegie không ? Người đã mệnh danh là Vua Thép của nước Mỹ. Hàng ngàn người làm việc cho ông có kiến thức về thép hơn ông rất nhiều, chỉ có điều ông biết cách đối xử với mọi người. Chính điều này đã khiến cho ông giàu có. Ông cũng sớm biểu lộ năng khiếu tổ chức và một tài năng thiên bẩm về nghệ thuật lãnh đạo. Mới 10 tuổi, ông đã phát hiện ra tầm quan trọng đáng kinh ngạc của việc gọi mọi người bằng tên riêng của họ và ông đã sử dụng phát hiện này để có được sự hợp tác nhiệt thành của mọi người trong suốt cuộc đời mình. Khi còn là một cậu bé ở Scotland, ông nuôi một cặp thỏ. Chẳng bao lâu sau, ông có cả một đám thỏ con nhưng khó khăn lúc đó là ông chẳng có gì để nuôi chúng cả. Vào một ngày đẹp trời, ông chợt nảy ra một sáng kiến : ông bảo bọn con trai, con gái trong vùng rằng nếu chúng kiếm được đủ cỏ ba lá và bồ công anh để nuôi bọn thỏ, ông sẽ lấy tên của chúng để đặt tên cho từng chú thỏ con. Kế hoạch đó thành công như một phép lạ và Carnegie không bao giờ quên điều này. Nhiều năm sau, ông đã kiếm được hàng triệu đôla cũng bằng cách sử dụng tâm lý này trong kinh doanh. Chằng hạn Andrew Carnegie muốn cung cấp đường ray bằng thép cho công ty đường sắt Tese Vania mà Edgar Thompson chính là Chủ Tịch. Thế là ông dựng lên một nhà máy thép khổng lồ ở Pittsburg và gọi nó là \"nhà máy thép Edgar Thompson\". Bạn hãy đoán xem công ty đường sắt Tese Vania cần thép làm đường rầy, Edgar Thompson sẽ mua thép của ai đây ? Nghệ thuật ghi nhớ, trân trọng tên bạn bè và các đối tác kinh doanh là một trong những bí quyết dẩn đến sự lãnh đạo thành công của Carnegie. Ông tự hào vì có thể gọi nhiều công nhân bằng cái tên riêng của họ và chưa hề có một cuộc đình công nào xảy ra tại các nhà máy thép trong thời ông nắm quyền. Ben Sinlov, Giám đốc của phòng thương mại Texas tin rằng : một tập đoàn càng tăng trưởng thì càng trở nên xa cách và ông đưa ra một giải pháp : có một cách kết nối tinh thần của tập đoàn, đó là nhớ được tên riêng của mọi người. Nhà Quản Trị nào bảo rằng ông ta không thể nhớ tên riêng nhân viên của mình thì cũng có nghĩa, ông ta không thể nhớ một phần quan trọng trong công việc của mình. Karen Chris, ở bang California, tiếp viên hàng không của hãng du lịch hàng không Mỹ, có thói quen học thuộc tên riêng của hành khách trong cabin và dùng tên riêng khi phục vụ họ. Hành khách hài lòng vì sự phục vụ của cô, đến nổi đã viết thư khen ngợi gởi cho hãng và cho riêng cô. Một hành khách viết : \"Tôi tới đi máy bay của hãng du lịch hàng không Mỹ lần đầu, nhưng từ nay, tôi sẽ chỉ đi với hãng này mà thôi. Phong cách phục vụ của các ông thật là đặc biệt, chân tình, và đó là điều quan trọng đối với tôi.\" Mọi người rất tự hào về cái tên riêng của mình nên cố gắng lưu danh bằng mọi giá. Từ bao thế kỷ nay, những nhà quý tộc, trùm tư bản, tài trợ cho các nghệ sĩ, nhạc sĩ và các tác giả, có mấy khi, ngoài mục đích để tên của mình được nằm trân trọng ở trang đầu tác phẩm ở phần đề tặng và cảm tạ. Các thư viện và các viện bảo tàng, sở dĩ có được những bộ sưu tập phong phú nhất, là nhờ những người không muốn để cho tên mình mất đi trong trí nhớ của nhân loại như thư viện New York có bộ sưu tập Esto và Lenos; Viện bảo tàng Chính phủ thì duy trì cái tên của Benjamin Altman và Chapis Morgan. Gần như nhà thờ nào cũng được tô điểm bởi những cửa sổ bằng kính màu ghi tên những người bảo trợ. Nhiều toà nhà, nhiều giảng đường của hầu hết các trường Đại Học, đều mang tên những người đã đóng góp những số tiền lớn cho trường. Hầu hết chúng ta không nhớ được tên người khác, đơn giản chỉ vì chúng ta thường đổ lỗi là do bận rộn mà không dành thời gian và công sức cần thiết để tập trung nhớ, lập đi lập lại và khắc sâu những thông tin đó vào tâm trí của mình. Đối với nhiều người, tên gọi chỉ đơn thuần là một cái tên. Quan niệm này hoàn toàn sai lầm. Khi chúng ta có thể nhớ và gọi tên người khác một cách chính xác, thân mật, chứng tỏ chúng ta đã thể hiện một sự quan tâm chân thành đến người đó và dĩ nhiên những ai được quan tâm chân thành cũng sẽ dành tình cảm tương tự cho chúng ta. Tổng thống Franklin Roosevelt hiển nhiên là người rất bận rộn, ấy thế mà ông vẫn dành thời gian để nhớ và có thể nhắc lại tên riêng cua mọi người, kể cả một người thợ máy bình thường mà ông có dịp tiếp xúc. Chuyện là công ty Chrysler sản xuất một chiếc xe riêng cho Tổng thống vì ông không thể sử dụng loại xe bình thường do hai chân bị bại liệt. Và Chamberlain, người của công ty Chrysler đã kể lại việc giao xe cho Tổng thống tại Nhà trắng trong bức thư gởi cho tôi như sau : \"Khi tôi đến Nhà trắng, Tổng thống chào tôi hết sức niềm nở. Ông gọi tôi bằng tên riêng khiến tôi cảm thấy rất thoải mái và đặc biệt gây cho tôi ấn tượng rằng ông thật sự quan tâm tới những điều tôi trình bày. Chiếc xe được thiết kế sao cho có thể sử dụng hoàn toàn bằng tay. Trước đám đông đang tập trung xung quanh ngấm nhìn chiếc xe, ông nhận xét : \"Tuyệt quá ! chỉ cần bấm nút là nó chạy mà không cần phải cố gắng gì nữa. Đẹp thật ! không biết làm sao mà nó hoạt động được. Hôm nào rảnh rổi, tôi phải tháo nó ra xem mới được\". Khi bạn bè và những người cộng tác của Tổng thống trầm trồ về chiếc xe, ông nói vơi tôi : \"Ông Chamberlain, tôi thật sự cảm kích việc các ông đã bỏ thời gian và công sức, sáng tạo ra chiếc xe này. Quả thật là điều tuyệt vời !\" Tổng thống ngắm bộ tản nhiệt, tấm gương phía sau, chiếc đồng hồ, đèn chiếu đặc biệt, vải bọc nệm, vị trí ngồi của người lái xe, những vali riêng trong hòm xe với những chữ lòng chéo vào nhau trên mỗi vali. Ông chú ý tới mọi chi tiết và cố tình nêu bậc những bộ phận này lên, để cho bà Roosevelt, Cô Jetkins, Bộ trưởng bộ lao động và thư ký riêng của ông, chú ý. Vừa nghe tôi hướng dẩn sử dụng xong, Tổng thống nói : \"Ông Chamberlain này, tôi đã để người bên Cục dự trử Liên Bang chờ hết 30 phút rồi, tôi cần phải trở lại làm việc thôi.\" Tôi có dẩn theo một người thợ máy. Anh ta rất nhút nhát, đứng lùi lại phía sau, không nói một câu nào. Tổng thống chỉ nghe tôi giới thiệu tên anh ta có một lần, lúc mới đến. Vậy mà trước khi đi, Tổng thống tìm người thợ máy này, bắt tay anh ta, gọi anh ta bằng tên riêng và cám ơn một cách chân thành. Vài ngày sau, khi trở về New York, tôi nhận được một bức chân dung có chữ ký của Tổng thống Roosevelt cộng với lời cám ơn. Ông tìm đâu ra thời gian để làm điều đó. Đây vẫn còn là điều bí ẩn đối với tôi.\" Franklin Roosevelt biết rằng một trong những cách đơn giản nhất, có hiệu quả nhất và quan trọng nhất để thu phục lòng người, là nhớ được tên riêng của họ và làm cho họ cảm thấy mình quan trọng. Và bao nhiêu người trong chúng ta đã thực hiện được điều đó ? Một trong những bài học đầu tiên của một chính trị gia là phải nhớ được tên của cử tri. Quên điều đó là sẽ dể bị mất đi vị thế của mình. Cũng như trong chính trị, khả năng nhớ được tên riêng cũng rất quan trọng trong kinh doanh và trong giao tiếp xã hội. Napoléon III, Hoàng đế của nước Pháp, cháu của Napoléon I, tự hào chia sẽ rằng mặc dù công việc rất bận rộn nhưng ông vẫn nhớ được tên của mọi người mà ông từng gặp. Ông đã làm điều đó như thế nào ? Rất đơn giản, nếu không nghe rõ được tên riêng, ông sẽ nói : \"xin lỗi, tôi không nghe rõ tên của bạn\". Nếu như đó là một cái tên hơi lạ, ông thường nói : \"xin lỗi, tên bạn được viết như thế nào ?\". Trong lúc nói chuyện, ông lập lại tên người đối thoại nhiều lần và tìm cách ghi nhớ tên ấy kết hợp với những đặc điểm trên gương mặt, phong thái và dáng điệu. Nếu đây là một nhân vật quan trọng, Napoléon III còn chịu khó hơn nữa. Ông viết tên người đó trên một mảnh giấy, nhìn thật kỷ rồi tập trung ghi nhớ. Với cách này, tai nghe, mắt thấy, trí óc tập trung, cái tên đó sẽ được nhớ mãi. Tất cả những thói quen tốt này rất cần có thời gian để rèn luyện và phát triển. Chúng ta cần nhận ra điều kỳ diệu ẩn chứa sau tên gọi của mổi con người. Và khi nhớ rằng mổi cái tên, dù đơn giản đến đâu, cũng chính là điều quan trọng và là niềm vui của người đó. Do vậy, thông tin mà chúng ta đang trao đổi, hay những câu chuyện giửa hai bên, sẽ trở nên thật đặc biệt khi chúng được lòng vào trong đó, tên của người mà chúng ta đang giao tiếp, cho dù họ là ai, người. Hầu bạn hay vị Tổng giám đốc, cái tên vẫn luôn đem lại điều kỳ diệu khi chúng ta gọi đúng nó. Những đức tính tốt được phát triển và rèn luyện từ rất nhiều công sức và lòng quyết tâm.";
        demobook.setContent(content);


        // Tao class texttospeech, set locale tieng viet
        textToSpeech = new TextToSpeech(getApplicationContext(), status -> {
            if (status == TextToSpeech.SUCCESS) {
                int lang = textToSpeech.setLanguage(new Locale("vie"));

                if (lang ==TextToSpeech.LANG_MISSING_DATA || lang == TextToSpeech.LANG_NOT_SUPPORTED)
                {
                    Toast.makeText(SpeechActivity.this, "Language not supported", Toast.LENGTH_SHORT).show();
                } else{
                    Toast.makeText(SpeechActivity.this, "Language supported", Toast.LENGTH_SHORT).show();
                }
            }
        });

        btnPause= (Button) findViewById(R.id.pause);
        btnPlay = (Button) findViewById(R.id.play);
        btnNext = (Button) findViewById(R.id.skip_next);
        btnPrevious = (Button) findViewById(R.id.skip_previous);

        // Xu li nut play
        btnPlay.setOnClickListener(v -> {
            String utteranceId = UUID.randomUUID().toString();
            textToSpeech.speak(content, TextToSpeech.QUEUE_FLUSH,null,utteranceId);
        });
        // Xu li nut Pause
        btnPause.setOnClickListener(v -> textToSpeech.stop());
    }

}